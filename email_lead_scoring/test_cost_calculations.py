import pandas as pd
import numpy as np
from cost_calculations import cost_tbl


def test_cost_tbl():
    # Test case 1: Default values
    expected_output_1 = pd.DataFrame(
        {
            "period": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
            "email_no_growth": [
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
                100000.0,
            ],
            "lost_customers_no_growth": [
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
                250.0,
            ],
            "cost_no_grown": [
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
                500000.0,
            ],
            "emails_with_growth": [
                100000.0,
                103500.0,
                107122.5,
                110871.06,
                114751.82,
                118770.29,
                122932.55,
                127244.42,
                131712.96,
                136345.61,
                141150.88,
                146137.47,
            ],
            "lost_customers_with_growth": [
                250.0,
                258.75,
                267.61,
                276.59,
                285.70,
                294.94,
                304.32,
                313.84,
                323.50,
                333.31,
                343.27,
                353.39,
            ],
            "cost_with_growth": [
                500000.0,
                517500.0,
                535225.0,
                553181.25,
                571375.31,
                589813.82,
                608503.64,
                627451.82,
                646665.92,
                666153.82,
                685923.88,
                705984.47,
            ],
        }
    )
    assert cost_tbl().equals(expected_output_1)

    # Test case 2: Custom values
    expected_output_2 = pd.DataFrame(
        {
            "period": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
            "email_no_growth": [
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
                50000.0,
            ],
            "lost_customers_no_growth": [
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
                62.5,
            ],
            "cost_no_grown": [
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
                125000.0,
            ],
            "emails_with_growth": [
                50000.0,
                51750.0,
                53522.5,
                55318.13,
                57137.82,
                58981.38,
                60850.36,
                62744.95,
                64666.72,
                66616.06,
                68593.47,
                70599.84,
            ],
            "lost_customers_with_growth": [
                62.5,
                64.69,
                66.95,
                69.29,
                71.71,
                74.21,
                76.79,
                79.46,
                82.22,
                85.07,
                87.99,
                91.01,
            ],
            "cost_with_growth": [
                125000.0,
                129375.0,
                133875.0,
                138506.25,
                143273.82,
                148183.82,
                153241.82,
                158454.95,
                163830.43,
                169375.32,
                175097.47,
                181004.84,
            ],
        }
    )
    assert cost_tbl(
        email_list_size=50000,
        email_list_growth_rate=0.03,
        emails_per_month=1000,
        unsub_rate=0.01,
        conversion_rate=0.1,
        customer_value=1000,
    ).equals(expected_output_2)

    print("All test cases pass")

test_cost_tbl()